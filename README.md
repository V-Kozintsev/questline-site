Проект questline разработан на Laravel с использованием Homestead, с подключением SMTP для Яндекс.Почты.


# Основные шаги для запуска Laravel-проекта на Homestead:

## Установить зависимости на своей машине:

- [VirtualBox](https://www.virtualbox.org/) — это наиболее часто используемый провайдер виртуальных машин.

- [Vagrant](https://developer.hashicorp.com/vagrant) — менеджер виртуальных сред.


## Перед настройкой проекта необходимо создать пароль приложения в вашем аккаунте Яндекс.Почты.

## Как создать пароль приложения для Яндекс.Почты
1. Перейдите на страницу управления Яндекс ID: `https://id.yandex.ru/`
2. Авторизуйтесь в своём аккаунте.
3. В меню слева выберите раздел `“Безопасность”`.
4. Найдите и кликните по пункту `“Пароли приложений”`.
5. Нажмите кнопку `“Создать пароль приложения”`.
6. В выпадающем списке выберите приложение — например, “Почта” или “Другое приложение”.
7. Укажите имя для пароля — например, “Laravel Mail”.
8. Нажмите кнопку `“Далее”`.
9. Скопируйте отображённый пароль приложения — он состоит из случайного набора символов и будет показан единожды.
10. Вставьте этот пароль в переменную `MAIL_PASSWORD` в `.env` вашего Laravel проекта.

## Включить галочку "Почтовые программы" в Яндекс.Почте

1. Перейдите в настройки > Почтовые программы;
2. Включите опцию "С сервера imap.yandex.ru по протоколу IMAP";
3. Сохраните настройки.

## Установка и запуск проекта.

1. - Скопируй проект 

```
https://github.com/V-Kozintsev/questline-site.git
```

2. - Установи зависимости проекта командой из корневой директории проекта:

```
composer install
```

```
npm install
```

3. - Скопируй файл `Homestead.yaml.example` и переименуй в `Homestead.yaml`. Отредактируй.

4. - Скопируй файл `.env.example` и переименуй в `.env`. Отредактируй.

5. - Отредактируй файл `hosts` на уровне системы, например, в Windows по пути `c:\windows\system32\drivers\etc\hosts`. Добавь строку:

```
192.168.10.10 questline.test
```

6. - Запускаем виртуалку:

```
vagrant up
```

## Если же появляется ошибка или предупреждение с текстом типа `"Repository ... changed its 'Label' value"` ,выполни следующее:

1. - Зайти внутрь виртуальной машины через SSH (`vagrant ssh`),что-бы выйти из виртуалки, то команда(`exit`)

2. - Выполни команду
```
sudo apt-get update --allow-releaseinfo-change
```

3. - Перезапусти виртуалку:

```
vagrant reload --provision
```

7. - Сгенерируй ключ приложения в директории `code`(через SSH на виртуалке `vagrant ssh`):

```
php artisan key:generate
```

8. - Выполни миграции базы данных:

```
php artisan migrate
```

9. - Создай символическую ссылку для хранения файлов:

```
php artisan storage:link
```

10. - Билдим проет
 
```
npm run build
```

11. - Перезагрузи виртуалки

```
vagrant reload --provision
```

### ПРОЕКТ ЗАПУЩЕН!

- Проверка бд в директории `code`(через SSH на виртуалке `vagrant ssh`):

```
mysql -u root -e "SHOW DATABASES;"
```

- Дамп БД
```
mysqldump -u DB_USERNAME -p DB_DATABASE > dump.sql
```

## Очистка кеша

- Выполни в терминале:

```
php artisan config:cache
```
```
php artisan route:cache
```
```
php artisan config:clear
```

## Команды vagrant

- Полное выключение 

```
vagrant halt
```
- Перезапуск (рестарт)

```
vagrant reload --provision
```


